@using DispatcherWeb.Authorization;
@using DispatcherWeb.Web.Areas.App.Models.Layout
@using DispatcherWeb.Web.Areas.App.Views.Shared.Components.AppMenu

@model MenuViewModel
<nav id="m_ver_menu"
     style="height:100vh"
     aria-label="@L("LeftMenu")"
     class="m-aside-menu  
            m-aside-menu--skin-light 
            m-aside-menu--submenu-skin-light"
     m-menu-vertical="1"
     m-menu-scrollable="1"
     m-menu-dropdown-timeout="500">
    @if (IsGranted(AppPermissions.Pages_Orders_Edit) 
        || IsGranted(AppPermissions.Pages_Quotes_Edit)
        || IsGranted(AppPermissions.Pages_DriverMessages)
        || IsGranted(AppPermissions.Pages_Trucks)
        || IsGranted(AppPermissions.Pages_Customers)
        || IsGranted(AppPermissions.Pages_Services)
        || IsGranted(AppPermissions.Pages_Drivers)
        || IsGranted(AppPermissions.Pages_Locations)
        || IsGranted(AppPermissions.Pages_Administration_Users_Create)
    )
    {
        <div class="common-add-button-group dropdown">
            <button class="btn btn-primary" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                <i class="fa fa-plus"></i>
                <span>@L("ADD")</span>
            </button>
            <div class="dropdown-menu">
                @if (IsGranted(AppPermissions.Pages_Orders_Edit))
                {
                    <a class="dropdown-item" href="#" id="CommonAddOrderButton">@L("GlobalAddOrder")</a>
                    <a class="dropdown-item" href="#" id="CommonAddJobButton">@L("GlobalAddJob")</a>
                }
                @if (IsGranted(AppPermissions.Pages_Quotes_Edit))
                {
                    <a class="dropdown-item" href="#" id="CommonAddQuoteButton">@L("GlobalAddQuote")</a>
                }
                @if (IsGranted(AppPermissions.Pages_DriverMessages))
                {
                    <a class="dropdown-item" href="#" id="CommonAddDriverMessageButton">@L("GlobalAddMessage")</a>
                }
                @if (IsGranted(AppPermissions.Pages_Trucks))
                {
                    <a class="dropdown-item" href="#" id="CommonAddTruckButton">@L("GlobalAddTruck")</a>
                }
                @if (IsGranted(AppPermissions.Pages_Customers))
                {
                    <a class="dropdown-item" href="#" id="CommonAddCustomerButton">@L("GlobalAddCustomer")</a>
                }
                @if (IsGranted(AppPermissions.Pages_Services))
                {
                    <a class="dropdown-item" href="#" id="CommonAddServiceButton">@L("GlobalAddProductOrService")</a>
                }
                @if (IsGranted(AppPermissions.Pages_Drivers))
                {
                    <a class="dropdown-item" href="#" id="CommonAddDriverButton">@L("GlobalAddDriver")</a>
                }
                @if (IsGranted(AppPermissions.Pages_Locations))
                {
                    <a class="dropdown-item" href="#" id="CommonAddLocationButton">@L("GlobalAddLocation")</a>
                }
                @if (IsGranted(AppPermissions.Pages_Administration_Users_Create))
                {
                    <a class="dropdown-item" href="#" id="CommonAddUserButton">@L("GlobalAddUser")</a>
                }
            </div>
        </div>
    }
    <ul class="m-menu__nav m-menu__nav--dropdown-submenu-arrow" 
        role="menubar" 
        aria-label="@L("LeftMenu")">
        @for (var i = 0; i < Model.Menu.Items.Count; i++)
        {
            var menuItem = Model.Menu.Items[i];
            @await Html.PartialAsync("Components/AppMenu/_UserMenuItem", new UserMenuItemViewModel
            {
                MenuItem = menuItem,
                MenuItemIndex = i,
                RootLevel = true,
                CurrentPageName = Model.CurrentPageName
            })
        }
    </ul>
</nav>