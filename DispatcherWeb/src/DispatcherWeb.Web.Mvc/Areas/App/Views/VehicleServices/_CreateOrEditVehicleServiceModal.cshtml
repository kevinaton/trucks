@using DispatcherWeb.Web.Areas.App.Models.Common.Modals
@using DispatcherWeb.Web.Areas.App.Models.VehicleServices
@model CreateOrEditVehicleServiceModalViewModel
@await Html.PartialAsync("~/Areas/app/Views/Common/Modals/_ModalHeader.cshtml", new ModalHeaderViewModel(Model.Id > 0 ? "Edit Service: " + Model.Name : "Create new service"))

<div class="modal-body box-wrap">
    <form role="form" novalidate class="form-validation">
        <input type="hidden" asp-for="Id" />
        <div class="form-group">
            <label class="required-label" asp-for="Name">@L("Name")</label>
            <input class="form-control" type="text" asp-for="Name" required maxlength="100">
        </div>
        <div class="form-group">
            <label>@L("Description")</label>
            <input type="text" class="form-control" asp-for="Description" maxlength="1000">
        </div>
        <div class="form-group">
            <label asp-for="RecommendedTimeInterval">@L("RecommendedTimeInterval"), @L("Days")</label>
            <input type="text" class="form-control" asp-for="RecommendedTimeInterval" data-rule-number="true" data-rule-digits="true" data-rule-min="0" data-rule-max="100000">
        </div>
        <div class="form-group">
            <label asp-for="WarningDays">@L("WarningDays")</label>
            <input type="text" class="form-control" asp-for="WarningDays" data-rule-number="true" data-rule-digits="true" data-rule-min="0" data-rule-max="100000">
        </div>
        <div class="form-group">
            <label asp-for="RecommendedMileageInterval">@L("RecommendedMileageInterval")</label>
            <input type="text" class="form-control" asp-for="RecommendedMileageInterval" data-rule-number="true" data-rule-digits="true" data-rule-min="0" data-rule-max="1000000">
        </div>
        <div class="form-group">
            <label asp-for="WarningMiles">@L("WarningMiles")</label>
            <input type="text" class="form-control" asp-for="WarningMiles" data-rule-number="true" data-rule-min="0" data-rule-digits="true" data-rule-max="1000000">
        </div>
        <div class="form-group">
            <label asp-for="RecommendedHourInterval">@L("RecommendedHourInterval")</label>
            <input type="text" class="form-control" asp-for="RecommendedHourInterval" data-rule-number="true" data-rule-digits="true" data-rule-min="0" data-rule-max="1000000000">
        </div>
        <div class="form-group">
            <label asp-for="WarningHours">@L("WarningHours")</label>
            <input type="text" class="form-control" asp-for="WarningHours" data-rule-number="true" data-rule-digits="true" data-rule-min="0" data-rule-max="1000000000">
        </div>
        
        <div class="form-group">
            <label>@L("Document")</label>
            <div>
                <div class="btn btn-primary fileinput-button">
                    <i class="fa fa-plus"></i>
                    <span> Select document file... </span>
                    <input id="Document" data-style="expand-right" type="file" accept="application/pdf" data-url="@Url.Action("UploadDocument")" />
                    <span id="Uploading" style="display: none;">  <i class="fa fa-spinner fa-spin"></i></span>
                </div>
                
            </div>
        </div>
        
        <table class="table table-striped table-bordered table-hover dt-responsive" id="DocumentsTable">
            <thead>
            <tr>
                <th></th>
                <th>@L("Name")</th>
                <th>@L("Description")</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            @foreach(var document in Model.Documents)
            {
                <tr data-id="@document.Id" data-file-id="@document.FileId">
                    <td><a class="btn btn-info" asp-action="DownloadDocument" asp-route-vehicleServiceId="@document.VehicleServiceId" asp-route-fileId="@document.FileId" asp-route-fileName="@document.Name">@L("Download")</a></td>
                    <td>
                        <input type="text" class="form-control" value="@document.Name"/>
                    </td>
                    <td><input type="text" class="form-control" value="@document.Description" /></td>
                    <td style="width: 20px"><button class="btn btn-danger btnDelete">@L("Delete")</button></td>
                </tr>
            }
            </tbody>
        </table>

    </form>


</div>

@await Html.PartialAsync("~/Areas/app/Views/Common/Modals/_ModalFooterWithSaveAndCancel.cshtml")

<script id="documentTemplate" type="x-tmpl-mustache">
    <tr data-id="{{id}}" data-file-id="{{fileId}}">
        <td><a class="btn btn-info" href="@(Url.Action("DownloadDocument") + Html.Encode("?vehicleServiceId={{vehicleServiceId}}&fileId={{fileId}}&fileName={{name}}"))">Download</a></td>
        <td>
            <input type="text" class="form-control" value="{{name}}" />
        </td>
        <td><input type="text" class="form-control" value="{{description}}" /></td>
        <td style="width: 20px"><button class="btn btn-danger btnDelete">Delete</button></td>
    </tr>
</script>